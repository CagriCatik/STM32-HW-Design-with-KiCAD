"use strict";(self.webpackChunkPCB_Design=self.webpackChunkPCB_Design||[]).push([[1921],{35003:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>a});const l=JSON.parse('{"id":"Schematic/Summary/power_decoupling_network","title":"Power and Decoupling Network","description":"The schematic defines the STM32F103C8T6 power subsystem with correct isolation between digital and analog domains, proper decoupling topology, and an LC-filtered analog supply. The circuit implements the recommended STM32F1 power architecture in a clean, stable configuration. This document also summarizes the step-by-step process used to build the schematic in KiCad.","source":"@site/docs/02_Schematic/Summary/01_power_decoupling_network.md","sourceDirName":"02_Schematic/Summary","slug":"/Schematic/Summary/power_decoupling_network","permalink":"/STM32-HW-Design-with-KiCAD/docs/Schematic/Summary/power_decoupling_network","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02_Schematic/Summary/01_power_decoupling_network.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"SchematicSidebar","previous":{"title":"Schematic","permalink":"/STM32-HW-Design-with-KiCAD/docs/Schematic/Final-Schematic"},"next":{"title":"Power, Reset, and Boot Configuration","permalink":"/STM32-HW-Design-with-KiCAD/docs/Schematic/Summary/power_boot_configuration"}}');var s=i(74848),r=i(28453),t=i(71904);const o={},c="Power and Decoupling Network",d={},a=[{value:"Decoupling",id:"decoupling",level:2},{value:"1. Tooling and project setup",id:"1-tooling-and-project-setup",level:2},{value:"2. Placing the STM32 microcontroller",id:"2-placing-the-stm32-microcontroller",level:2},{value:"3. Ground system",id:"3-ground-system",level:2},{value:"Symbol placement",id:"symbol-placement",level:3},{value:"Connections",id:"connections",level:3},{value:"4. Power distribution",id:"4-power-distribution",level:2},{value:"Digital rail (+3.3 V)",id:"digital-rail-33-v",level:3},{value:"Analog rail (+3.3VA)",id:"analog-rail-33va",level:3},{value:"5. Digital supply decoupling",id:"5-digital-supply-decoupling",level:2},{value:"Topology",id:"topology",level:3},{value:"Implementation steps in KiCad",id:"implementation-steps-in-kicad",level:3},{value:"Purpose",id:"purpose",level:3},{value:"6. Analog supply decoupling and filtering",id:"6-analog-supply-decoupling-and-filtering",level:2},{value:"Network structure",id:"network-structure",level:3},{value:"Rationale",id:"rationale",level:3},{value:"7. Pin configuration status",id:"7-pin-configuration-status",level:2},{value:"8. Design rules checklist",id:"8-design-rules-checklist",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"power-and-decoupling-network",children:"Power and Decoupling Network"})}),"\n",(0,s.jsx)(n.p,{children:"The schematic defines the STM32F103C8T6 power subsystem with correct isolation between digital and analog domains, proper decoupling topology, and an LC-filtered analog supply. The circuit implements the recommended STM32F1 power architecture in a clean, stable configuration. This document also summarizes the step-by-step process used to build the schematic in KiCad."}),"\n","\n",(0,s.jsx)(n.h2,{id:"decoupling",children:"Decoupling"}),"\n",(0,s.jsx)("div",{style:{textAlign:"center"},children:(0,s.jsx)("img",{src:t.A,alt:"decoupling",style:{width:"500px"}})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"1-tooling-and-project-setup",children:"1. Tooling and project setup"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Create a new project: ",(0,s.jsx)(n.code,{children:"File -> New Project"}),", choose a name and location."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Open the schematic editor."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Basic navigation:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Middle mouse button: pan"}),"\n",(0,s.jsx)(n.li,{children:"Scroll wheel: zoom"}),"\n",(0,s.jsx)(n.li,{children:"Right click: context menu"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Esc"}),": cancel current command"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The first task in any PCB design is schematic capture: placing symbols (components) and wiring them together."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"2-placing-the-stm32-microcontroller",children:"2. Placing the STM32 microcontroller"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.code,{children:"Add Symbol"})," in the right toolbar."]}),"\n",(0,s.jsxs)(n.li,{children:["In the symbol chooser, search for ",(0,s.jsx)(n.code,{children:"STM32F103C8Tx"}),".","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"STM32"})," is the family."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"F1"})," denotes the performance and feature line."]}),"\n",(0,s.jsxs)(n.li,{children:["The trailing letters (for example ",(0,s.jsx)(n.code,{children:"C8T6"}),") encode package, flash, and RAM size."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Place the ",(0,s.jsx)(n.code,{children:"STM32F103C8Tx"})," symbol roughly in the center of the schematic."]}),"\n",(0,s.jsxs)(n.li,{children:["Optionally:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Align the reference designator (",(0,s.jsx)(n.code,{children:"U1"}),") at the top of the symbol."]}),"\n",(0,s.jsxs)(n.li,{children:["Edit the value field to the exact part number (for example ",(0,s.jsx)(n.code,{children:"STM32F103C8T6"}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The MCU symbol groups pins into:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Power pins: ",(0,s.jsx)(n.code,{children:"VBAT"}),", ",(0,s.jsx)(n.code,{children:"VDD"}),", ",(0,s.jsx)(n.code,{children:"VDDA"}),", ",(0,s.jsx)(n.code,{children:"VSS"}),", ",(0,s.jsx)(n.code,{children:"VSSA"})]}),"\n",(0,s.jsxs)(n.li,{children:["Configuration and reset: ",(0,s.jsx)(n.code,{children:"BOOT0"}),", ",(0,s.jsx)(n.code,{children:"NRST"})]}),"\n",(0,s.jsxs)(n.li,{children:["GPIO banks: ",(0,s.jsx)(n.code,{children:"PAx"}),", ",(0,s.jsx)(n.code,{children:"PBx"}),", ",(0,s.jsx)(n.code,{children:"PCx"}),", ",(0,s.jsx)(n.code,{children:"PDx"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The rest of the schematic builds the infrastructure this device requires to run reliably: power rails, grounds, clocks, connectors, and so on. This document focuses on power and decoupling."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"3-ground-system",children:"3. Ground system"}),"\n",(0,s.jsx)(n.h3,{id:"symbol-placement",children:"Symbol placement"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.code,{children:"Add Power Port"})," and choose the ",(0,s.jsx)(n.code,{children:"GND"})," symbol."]}),"\n",(0,s.jsxs)(n.li,{children:["Place a single ",(0,s.jsx)(n.code,{children:"GND"})," symbol below the MCU."]}),"\n",(0,s.jsx)(n.li,{children:"Optionally hide the text label if there is only one ground domain in the design."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"connections",children:"Connections"}),"\n",(0,s.jsxs)(n.p,{children:["Use the wire tool (",(0,s.jsx)(n.code,{children:"W"}),") to connect:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["All ",(0,s.jsx)(n.code,{children:"VSS"})," pins to the ground node"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"VSSA"})," (analog ground) to the same ground node"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Rationale:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"VSS"})," is the digital ground reference."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"VSSA"})," is the analog ground reference for the ADC and DAC."]}),"\n",(0,s.jsx)(n.li,{children:"For STM32F1, both must be tied together. Layout can implement this as a local star point or short trace, but logically they share a single ground net."}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"4-power-distribution",children:"4. Power distribution"}),"\n",(0,s.jsx)(n.p,{children:"The MCU is powered from a 3.3 V rail. Two related rails are used."}),"\n",(0,s.jsx)(n.h3,{id:"digital-rail-33-v",children:"Digital rail (+3.3 V)"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Add a ",(0,s.jsx)(n.code,{children:"+3.3V"})," power symbol and place it near ",(0,s.jsx)(n.code,{children:"VBAT"})," and the ",(0,s.jsx)(n.code,{children:"VDD"})," pins."]}),"\n",(0,s.jsxs)(n.li,{children:["Connect ",(0,s.jsx)(n.code,{children:"VBAT"})," to ",(0,s.jsx)(n.code,{children:"+3.3V"})," when no backup battery is used and the internal RTC is not powered from a separate source."]}),"\n",(0,s.jsxs)(n.li,{children:["Connect both ",(0,s.jsx)(n.code,{children:"VDD"})," pins to the same ",(0,s.jsx)(n.code,{children:"+3.3V"})," node."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Voltage range for this STM32F1 variant is roughly 2.7 V to 3.6 V; 3.3 V is the standard operating point."}),"\n",(0,s.jsx)(n.h3,{id:"analog-rail-33va",children:"Analog rail (+3.3VA)"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Introduce a separate net label, for example ",(0,s.jsx)(n.code,{children:"+3.3VA"}),", for the analog supply."]}),"\n",(0,s.jsx)(n.li,{children:"Derive this rail from the digital 3.3 V rail through a ferrite bead and its own decoupling network, as described in section 6."}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"5-digital-supply-decoupling",children:"5. Digital supply decoupling"}),"\n",(0,s.jsx)(n.h3,{id:"topology",children:"Topology"}),"\n",(0,s.jsx)(n.p,{children:"Five capacitors (C1 through C5) are connected in parallel between the digital +3.3 V node and ground:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Several 100 nF capacitors"}),"\n",(0,s.jsx)(n.li,{children:"One 10 nF capacitor"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Each VDD and VBAT pin should have a local 100 nF capacitor. In addition, a bulk capacitor provides extra energy storage."}),"\n",(0,s.jsx)(n.h3,{id:"implementation-steps-in-kicad",children:"Implementation steps in KiCad"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Add a capacitor symbol (",(0,s.jsx)(n.code,{children:"C"}),") and place it near a VDD pin."]}),"\n",(0,s.jsxs)(n.li,{children:["Set its value to ",(0,s.jsx)(n.code,{children:"100n"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Wire one side to ",(0,s.jsx)(n.code,{children:"+3.3V"})," at the corresponding pin, the other side to the ground node."]}),"\n",(0,s.jsxs)(n.li,{children:["Copy (",(0,s.jsx)(n.code,{children:"C"}),", then ",(0,s.jsx)(n.code,{children:"Ctrl+V"}),") this capacitor for each VDD and VBAT pin."]}),"\n",(0,s.jsxs)(n.li,{children:["Add one bulk capacitor (for example ",(0,s.jsx)(n.code,{children:"10uF"}),") between ",(0,s.jsx)(n.code,{children:"+3.3V"})," and ",(0,s.jsx)(n.code,{children:"GND"})," close to the MCU symbol."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"purpose",children:"Purpose"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The 100 nF capacitors present a low impedance at high frequencies and handle fast current edges when the core and I O switch."}),"\n",(0,s.jsx)(n.li,{children:"The bulk capacitor stabilizes the local rail against slower transients and cable inductance."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Placement rule: these capacitors must be placed as close as possible to the associated pins in the PCB layout, with short, wide traces to the power and ground planes."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"6-analog-supply-decoupling-and-filtering",children:"6. Analog supply decoupling and filtering"}),"\n",(0,s.jsx)(n.p,{children:"The analog supply is more sensitive to noise, especially for ADC and DAC performance. The schematic uses an LC type filter plus local decoupling."}),"\n",(0,s.jsx)(n.h3,{id:"network-structure",children:"Network structure"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"A ferrite bead FB1 (120 ohms at 100 MHz) connects the digital +3.3 V rail to the analog rail."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"On the analog side of FB1:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["C8: 1 uF between ",(0,s.jsx)(n.code,{children:"+3.3VA"})," and ground (right after the bead)"]}),"\n",(0,s.jsxs)(n.li,{children:["C6: 10 nF between ",(0,s.jsx)(n.code,{children:"VDDA"})," and ground"]}),"\n",(0,s.jsxs)(n.li,{children:["C7: 1 uF between ",(0,s.jsx)(n.code,{children:"VDDA"})," and ground"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"VDDA"})," is tied to the ",(0,s.jsx)(n.code,{children:"+3.3VA"})," rail, which is the output of the ferrite bead filter."]}),"\n",(0,s.jsx)(n.h3,{id:"rationale",children:"Rationale"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The ferrite bead presents high impedance at high frequency, blocking digital switching noise from entering the analog domain."}),"\n",(0,s.jsx)(n.li,{children:"C8 provides bulk decoupling for the entire analog rail."}),"\n",(0,s.jsx)(n.li,{children:"The C6 and C7 pair at VDDA provides both high frequency and low frequency local charge storage directly at the pin."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This topology matches STMicroelectronics reference schematics for STM32F1 devices."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"7-pin-configuration-status",children:"7. Pin configuration status"}),"\n",(0,s.jsx)(n.p,{children:"On this schematic page, GPIO pins are intentionally left unconnected, because the focus is solely on the power system."}),"\n",(0,s.jsx)(n.p,{children:"Two important pins are present but not fully constrained yet:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"BOOT0"}),": must be pulled down, typically with a 10 k resistor, to ensure normal boot from flash."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"NRST"}),": should be pulled up, typically with a 10 k resistor, and may have an additional 100 nF capacitor to ground for reset pulse shaping and noise immunity."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"These constraints are usually implemented on the same page or on a dedicated reset and configuration page."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"8-design-rules-checklist",children:"8. Design rules checklist"}),"\n",(0,s.jsx)(n.p,{children:"The implemented network satisfies the key power integrity rules for a basic STM32F103C8T6 design:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"All digital supply pins (VDD, VBAT) share a low impedance 3.3 V node."}),"\n",(0,s.jsx)(n.li,{children:"Each VDD and VBAT pin has a dedicated 100 nF ceramic capacitor to ground."}),"\n",(0,s.jsx)(n.li,{children:"A bulk capacitor around 10 uF is placed on the digital 3.3 V rail near the MCU."}),"\n",(0,s.jsx)(n.li,{children:"VDDA is supplied from 3.3 V through a ferrite bead and has its own 10 nF and 1 uF capacitors."}),"\n",(0,s.jsx)(n.li,{children:"An additional 1 uF capacitor is placed immediately after the ferrite bead on the analog rail."}),"\n",(0,s.jsx)(n.li,{children:"VSS and VSSA are tied together to a single ground reference."}),"\n",(0,s.jsxs)(n.li,{children:["The schematic clearly distinguishes digital (",(0,s.jsx)(n.code,{children:"+3.3V"}),") and analog (",(0,s.jsx)(n.code,{children:"+3.3VA"}),") rails with separate net names."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This structure is directly suitable as the power and decoupling foundation for a Blue Pill style STM32F103 board."})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},71904:(e,n,i)=>{i.d(n,{A:()=>l});const l=i.p+"assets/images/schematic_stm32_decoupling-3e44cb0141cec90b7382f5e12ce76b66.png"},28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>o});var l=i(96540);const s={},r=l.createContext(s);function t(e){const n=l.useContext(r);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);