"use strict";(self.webpackChunkPCB_Design=self.webpackChunkPCB_Design||[]).push([[9843],{2e3:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"Schematic/Crystal-Circuitry","title":"Connecting the Crystal Oscillator in STM32 Microcontroller Circuits","description":"Integrating a crystal oscillator into your STM32 microcontroller circuit is a pivotal step in ensuring accurate timing, especially for high-speed communication protocols such as USB, CAN, and UART. This document provides a comprehensive guide on designing and implementing a crystal oscillator circuit using KiCad, covering fundamental principles, component selection, schematic design, and best practices.","source":"@site/docs/02_Schematic/04_Crystal-Circuitry.md","sourceDirName":"02_Schematic","slug":"/Schematic/Crystal-Circuitry","permalink":"/STM32-HW-Design-with-KiCAD/docs/Schematic/Crystal-Circuitry","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02_Schematic/04_Crystal-Circuitry.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"SchematicSidebar","previous":{"title":"STM32 CubeIDE for Pinout Configuration and Peripheral Setup","permalink":"/STM32-HW-Design-with-KiCAD/docs/Schematic/Pin-Out_STM32CubeIDE"},"next":{"title":"Connecting USB Circuitry to STM32","permalink":"/STM32-HW-Design-with-KiCAD/docs/Schematic/USB"}}');var l=s(4848),a=s(8453);const c={},t="Connecting the Crystal Oscillator in STM32 Microcontroller Circuits",r={},o=[{value:"1. The Role of the Crystal Oscillator in STM32 Microcontrollers",id:"1-the-role-of-the-crystal-oscillator-in-stm32-microcontrollers",level:2},{value:"Importance of a Precise Clock Source",id:"importance-of-a-precise-clock-source",level:3},{value:"Internal vs. External Oscillators",id:"internal-vs-external-oscillators",level:3},{value:"Typical Crystal Oscillator Circuit Components",id:"typical-crystal-oscillator-circuit-components",level:3},{value:"2. Crystal Package Types and Symbol Selection in KiCad",id:"2-crystal-package-types-and-symbol-selection-in-kicad",level:2},{value:"Crystal Oscillator Package Configurations",id:"crystal-oscillator-package-configurations",level:3},{value:"Selecting the Crystal Symbol in KiCad",id:"selecting-the-crystal-symbol-in-kicad",level:3},{value:"Pin Configuration for a Four-Pin Crystal",id:"pin-configuration-for-a-four-pin-crystal",level:3},{value:"3. Understanding the Crystal Circuit Design",id:"3-understanding-the-crystal-circuit-design",level:2},{value:"Built-in Microcontroller Features",id:"built-in-microcontroller-features",level:3},{value:"External Components Required",id:"external-components-required",level:3},{value:"Typical Crystal Oscillator Circuit Layout",id:"typical-crystal-oscillator-circuit-layout",level:3},{value:"External Components: Load Capacitors",id:"external-components-load-capacitors",level:3},{value:"4. Application Note AN2867: Oscillator Design for STM32",id:"4-application-note-an2867-oscillator-design-for-stm32",level:2},{value:"Key Guidelines from AN2867",id:"key-guidelines-from-an2867",level:3},{value:"Best Practices",id:"best-practices",level:3},{value:"5. Calculating the Load Capacitor Values",id:"5-calculating-the-load-capacitor-values",level:2},{value:"Load Capacitor Calculation Formula",id:"load-capacitor-calculation-formula",level:3},{value:"Example Calculation",id:"example-calculation",level:3},{value:"Steps in KiCad to Add Load Capacitors",id:"steps-in-kicad-to-add-load-capacitors",level:3},{value:"Crystal Circuit Without Feedback Resistor",id:"crystal-circuit-without-feedback-resistor",level:3},{value:"6. Connecting the Crystal in KiCad",id:"6-connecting-the-crystal-in-kicad",level:2},{value:"Steps to Connect the Crystal to the STM32",id:"steps-to-connect-the-crystal-to-the-stm32",level:3},{value:"Routing and Naming the Net Labels",id:"routing-and-naming-the-net-labels",level:3},{value:"Best Practices for Routing",id:"best-practices-for-routing",level:3},{value:"7. Reviewing the Schematic for the Crystal Circuit",id:"7-reviewing-the-schematic-for-the-crystal-circuit",level:2},{value:"Schematic Components Overview",id:"schematic-components-overview",level:3},{value:"Verification Checklist",id:"verification-checklist",level:3},{value:"8. Validating the Crystal Circuit",id:"8-validating-the-crystal-circuit",level:2},{value:"Validation Steps",id:"validation-steps",level:3},{value:"Troubleshooting Common Issues",id:"troubleshooting-common-issues",level:3},{value:"Conclusion",id:"conclusion",level:2},{value:"Key Takeaways",id:"key-takeaways",level:3}];function d(e){const n={annotation:"annotation",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",mtext:"mtext",ol:"ol",p:"p",semantics:"semantics",span:"span",ul:"ul",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"connecting-the-crystal-oscillator-in-stm32-microcontroller-circuits",children:"Connecting the Crystal Oscillator in STM32 Microcontroller Circuits"})}),"\n",(0,l.jsx)(n.p,{children:"Integrating a crystal oscillator into your STM32 microcontroller circuit is a pivotal step in ensuring accurate timing, especially for high-speed communication protocols such as USB, CAN, and UART. This document provides a comprehensive guide on designing and implementing a crystal oscillator circuit using KiCad, covering fundamental principles, component selection, schematic design, and best practices."}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"1-the-role-of-the-crystal-oscillator-in-stm32-microcontrollers",children:"1. The Role of the Crystal Oscillator in STM32 Microcontrollers"}),"\n",(0,l.jsx)(n.h3,{id:"importance-of-a-precise-clock-source",children:"Importance of a Precise Clock Source"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Accurate Timing: Critical for the reliable operation of microcontrollers, especially in applications involving high-speed data transmission."}),"\n",(0,l.jsx)(n.li,{children:"Stable Communication Protocols: Ensures consistency and reduces errors in protocols like USB, CAN, and UART."}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"internal-vs-external-oscillators",children:"Internal vs. External Oscillators"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Internal Oscillator:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Advantages: Simplifies the design by reducing external components."}),"\n",(0,l.jsx)(n.li,{children:"Disadvantages: Generally less accurate and stable, unsuitable for timing-critical applications."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["High-Speed External (HSE) Clock:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Advantages: Provides higher accuracy and stability."}),"\n",(0,l.jsx)(n.li,{children:"Implementation: Utilizes a crystal oscillator connected to the HSE pins (OSC_IN and OSC_OUT) on the STM32 microcontroller."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"typical-crystal-oscillator-circuit-components",children:"Typical Crystal Oscillator Circuit Components"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Crystal: Typically a 16 MHz component connected between OSC_IN and OSC_OUT."}),"\n",(0,l.jsx)(n.li,{children:"Load Capacitors: Stabilize the oscillation frequency, ensuring accurate timing."}),"\n",(0,l.jsx)(n.li,{children:"Optional Feedback Resistors: May be used for controlling signal distortion."}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"2-crystal-package-types-and-symbol-selection-in-kicad",children:"2. Crystal Package Types and Symbol Selection in KiCad"}),"\n",(0,l.jsx)(n.h3,{id:"crystal-oscillator-package-configurations",children:"Crystal Oscillator Package Configurations"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Two-Pin Configuration:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Common Usage: Widely used due to simplicity."}),"\n",(0,l.jsx)(n.li,{children:"Applications: Suitable for most standard crystal oscillator requirements."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Four-Pin Configuration:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Enhanced Stability: Grounding additional pins can improve signal stability and reduce electromagnetic interference (EMI)."}),"\n",(0,l.jsx)(n.li,{children:"Use Case: Preferred in environments where noise reduction is critical."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"selecting-the-crystal-symbol-in-kicad",children:"Selecting the Crystal Symbol in KiCad"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Accessing Symbols:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Navigate to the Add Symbol tool within KiCad\u2019s schematic editor."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Searching for Crystal Symbols:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:'Enter "Crystal" in the symbol library search bar.'}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Choosing the Appropriate Symbol:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Two-Pin Crystal: Select for simpler designs."}),"\n",(0,l.jsx)(n.li,{children:"Four-Pin Crystal: Opt for enhanced stability and noise reduction."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Placing the Symbol:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Position the crystal symbol near the HSE_IN and HSE_OUT pins of the STM32 microcontroller on the schematic for logical layout and ease of routing."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"pin-configuration-for-a-four-pin-crystal",children:"Pin Configuration for a Four-Pin Crystal"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Pins 1 and 3:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Function: Connect to HSE_IN (OSC_IN) and HSE_OUT (OSC_OUT) on the STM32."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Pins 2 and 4:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Function: Grounded to enhance stability and minimize electromagnetic interference."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"3-understanding-the-crystal-circuit-design",children:"3. Understanding the Crystal Circuit Design"}),"\n",(0,l.jsx)(n.h3,{id:"built-in-microcontroller-features",children:"Built-in Microcontroller Features"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Inverters and Feedback Resistors:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Integrated into the STM32, these components assist in forming a stable oscillation circuit."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"external-components-required",children:"External Components Required"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Load Capacitors:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Purpose: Stabilize the oscillation frequency."}),"\n",(0,l.jsx)(n.li,{children:"Selection Criteria: Based on crystal load capacitance and PCB stray capacitance."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Optional Feedback Resistors:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Function: Limit signal distortion."}),"\n",(0,l.jsx)(n.li,{children:"Consideration: Often omitted unless specific distortion control is required."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"typical-crystal-oscillator-circuit-layout",children:"Typical Crystal Oscillator Circuit Layout"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Crystal Connection:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Between HSE_IN (PD0) and HSE_OUT (PD1) pins of the STM32."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Load Capacitors:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Two identical capacitors connected from each crystal pin to ground."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Feedback Resistor:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Optional series resistor connected to manage signal integrity."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"external-components-load-capacitors",children:"External Components: Load Capacitors"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Role in Oscillation:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ensure the crystal oscillates at its designated frequency by providing necessary capacitive loading."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Determining Capacitor Values:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Based on the crystal\u2019s specified load capacitance and the PCB\u2019s stray capacitance."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"4-application-note-an2867-oscillator-design-for-stm32",children:"4. Application Note AN2867: Oscillator Design for STM32"}),"\n",(0,l.jsx)(n.p,{children:"STMicroelectronics' Application Note AN2867 serves as an essential reference for designing reliable crystal oscillator circuits for STM32 microcontrollers."}),"\n",(0,l.jsx)(n.h3,{id:"key-guidelines-from-an2867",children:"Key Guidelines from AN2867"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Crystal Load Capacitors:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Critical for stabilizing oscillation."}),"\n",(0,l.jsx)(n.li,{children:"Work in conjunction with the STM32's internal oscillator circuitry to generate a stable clock signal."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Stray Capacitance Considerations:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Arises from PCB traces and nearby components."}),"\n",(0,l.jsx)(n.li,{children:"Typically ranges between 3-5 pF."}),"\n",(0,l.jsx)(n.li,{children:"Must be accounted for when calculating load capacitor values."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Feedback Resistor Usage:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Generally optional."}),"\n",(0,l.jsx)(n.li,{children:"May be included to prevent overdriving the crystal and reduce distortion."}),"\n",(0,l.jsx)(n.li,{children:"Many designs operate effectively without it, simplifying the circuit."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Adherence to Guidelines:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Following AN2867 ensures reliable oscillator performance and minimizes design errors."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Component Selection:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Carefully choose capacitors and resistors based on the application requirements and guidelines provided."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"5-calculating-the-load-capacitor-values",children:"5. Calculating the Load Capacitor Values"}),"\n",(0,l.jsx)(n.p,{children:"Accurate calculation of load capacitors is essential for ensuring the crystal oscillates at the desired frequency."}),"\n",(0,l.jsx)(n.h3,{id:"load-capacitor-calculation-formula",children:"Load Capacitor Calculation Formula"}),"\n",(0,l.jsx)(n.span,{className:"katex-display",children:(0,l.jsxs)(n.span,{className:"katex",children:[(0,l.jsx)(n.span,{className:"katex-mathml",children:(0,l.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(n.semantics,{children:[(0,l.jsxs)(n.mrow,{children:[(0,l.jsxs)(n.msub,{children:[(0,l.jsx)(n.mi,{children:"C"}),(0,l.jsxs)(n.mrow,{children:[(0,l.jsx)(n.mi,{children:"l"}),(0,l.jsx)(n.mi,{children:"o"}),(0,l.jsx)(n.mi,{children:"a"}),(0,l.jsx)(n.mi,{children:"d"})]})]}),(0,l.jsx)(n.mo,{children:"="}),(0,l.jsxs)(n.mfrac,{children:[(0,l.jsxs)(n.mrow,{children:[(0,l.jsxs)(n.msub,{children:[(0,l.jsx)(n.mi,{children:"C"}),(0,l.jsxs)(n.mrow,{children:[(0,l.jsx)(n.mi,{children:"c"}),(0,l.jsx)(n.mi,{children:"r"}),(0,l.jsx)(n.mi,{children:"y"}),(0,l.jsx)(n.mi,{children:"s"}),(0,l.jsx)(n.mi,{children:"t"}),(0,l.jsx)(n.mi,{children:"a"}),(0,l.jsx)(n.mi,{children:"l"})]})]}),(0,l.jsx)(n.mo,{children:"\u2212"}),(0,l.jsxs)(n.msub,{children:[(0,l.jsx)(n.mi,{children:"C"}),(0,l.jsxs)(n.mrow,{children:[(0,l.jsx)(n.mi,{children:"s"}),(0,l.jsx)(n.mi,{children:"t"}),(0,l.jsx)(n.mi,{children:"r"}),(0,l.jsx)(n.mi,{children:"a"}),(0,l.jsx)(n.mi,{children:"y"})]})]})]}),(0,l.jsx)(n.mn,{children:"2"})]})]}),(0,l.jsx)(n.annotation,{encoding:"application/x-tex",children:"C_{load} = \\frac{C_{crystal} - C_{stray}}{2}"})]})})}),(0,l.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(n.span,{className:"base",children:[(0,l.jsx)(n.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,l.jsxs)(n.span,{className:"mord",children:[(0,l.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"}),(0,l.jsx)(n.span,{className:"msupsub",children:(0,l.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(n.span,{className:"vlist-r",children:[(0,l.jsx)(n.span,{className:"vlist",style:{height:"0.3361em"},children:(0,l.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,l.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(n.span,{className:"mord mtight",children:[(0,l.jsx)(n.span,{className:"mord mathnormal mtight",style:{marginRight:"0.01968em"},children:"l"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",children:"o"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",children:"a"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",children:"d"})]})})]})}),(0,l.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(n.span,{className:"vlist-r",children:(0,l.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(n.span,{})})})]})})]}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(n.span,{className:"mrel",children:"="}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(n.span,{className:"base",children:[(0,l.jsx)(n.span,{className:"strut",style:{height:"2.0463em",verticalAlign:"-0.686em"}}),(0,l.jsxs)(n.span,{className:"mord",children:[(0,l.jsx)(n.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(n.span,{className:"mfrac",children:(0,l.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(n.span,{className:"vlist-r",children:[(0,l.jsxs)(n.span,{className:"vlist",style:{height:"1.3603em"},children:[(0,l.jsxs)(n.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(n.span,{className:"mord",children:(0,l.jsx)(n.span,{className:"mord",children:"2"})})]}),(0,l.jsxs)(n.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(n.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(n.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(n.span,{className:"mord",children:[(0,l.jsxs)(n.span,{className:"mord",children:[(0,l.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"}),(0,l.jsx)(n.span,{className:"msupsub",children:(0,l.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(n.span,{className:"vlist-r",children:[(0,l.jsx)(n.span,{className:"vlist",style:{height:"0.3361em"},children:(0,l.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,l.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(n.span,{className:"mord mtight",children:[(0,l.jsx)(n.span,{className:"mord mathnormal mtight",children:"crys"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",children:"t"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",children:"a"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",style:{marginRight:"0.01968em"},children:"l"})]})})]})}),(0,l.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(n.span,{className:"vlist-r",children:(0,l.jsx)(n.span,{className:"vlist",style:{height:"0.2861em"},children:(0,l.jsx)(n.span,{})})})]})})]}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(n.span,{className:"mbin",children:"\u2212"}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(n.span,{className:"mord",children:[(0,l.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"}),(0,l.jsx)(n.span,{className:"msupsub",children:(0,l.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(n.span,{className:"vlist-r",children:[(0,l.jsx)(n.span,{className:"vlist",style:{height:"0.2806em"},children:(0,l.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,l.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(n.span,{className:"mord mtight",children:[(0,l.jsx)(n.span,{className:"mord mathnormal mtight",children:"s"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",children:"t"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"r"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",children:"a"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})]})})]})}),(0,l.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(n.span,{className:"vlist-r",children:(0,l.jsx)(n.span,{className:"vlist",style:{height:"0.2861em"},children:(0,l.jsx)(n.span,{})})})]})})]})]})]})]}),(0,l.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(n.span,{className:"vlist-r",children:(0,l.jsx)(n.span,{className:"vlist",style:{height:"0.686em"},children:(0,l.jsx)(n.span,{})})})]})}),(0,l.jsx)(n.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"C_crystal: Load capacitance specified in the crystal's datasheet (typically 10-20 pF)."}),"\n",(0,l.jsx)(n.li,{children:"C_stray: Estimated stray capacitance from the PCB (typically 3-5 pF)."}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"example-calculation",children:"Example Calculation"}),"\n",(0,l.jsx)(n.p,{children:"Given:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Crystal Load Capacitance (C_crystal): 10 pF"}),"\n",(0,l.jsx)(n.li,{children:"Stray Capacitance (C_stray): 5 pF"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Calculation:"}),"\n",(0,l.jsx)(n.span,{className:"katex-display",children:(0,l.jsxs)(n.span,{className:"katex",children:[(0,l.jsx)(n.span,{className:"katex-mathml",children:(0,l.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(n.semantics,{children:[(0,l.jsxs)(n.mrow,{children:[(0,l.jsxs)(n.msub,{children:[(0,l.jsx)(n.mi,{children:"C"}),(0,l.jsxs)(n.mrow,{children:[(0,l.jsx)(n.mi,{children:"l"}),(0,l.jsx)(n.mi,{children:"o"}),(0,l.jsx)(n.mi,{children:"a"}),(0,l.jsx)(n.mi,{children:"d"})]})]}),(0,l.jsx)(n.mo,{children:"="}),(0,l.jsxs)(n.mfrac,{children:[(0,l.jsxs)(n.mrow,{children:[(0,l.jsx)(n.mn,{children:"10"}),(0,l.jsx)(n.mtext,{children:"\u2009"}),(0,l.jsx)(n.mtext,{children:"pF"}),(0,l.jsx)(n.mo,{children:"\u2212"}),(0,l.jsx)(n.mn,{children:"5"}),(0,l.jsx)(n.mtext,{children:"\u2009"}),(0,l.jsx)(n.mtext,{children:"pF"})]}),(0,l.jsx)(n.mn,{children:"2"})]}),(0,l.jsx)(n.mo,{children:"="}),(0,l.jsx)(n.mn,{children:"2.5"}),(0,l.jsx)(n.mtext,{children:"\u2009"}),(0,l.jsx)(n.mtext,{children:"pF"})]}),(0,l.jsx)(n.annotation,{encoding:"application/x-tex",children:"C_{load} = \\frac{10 \\, \\text{pF} - 5 \\, \\text{pF}}{2} = 2.5 \\, \\text{pF}"})]})})}),(0,l.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(n.span,{className:"base",children:[(0,l.jsx)(n.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,l.jsxs)(n.span,{className:"mord",children:[(0,l.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"}),(0,l.jsx)(n.span,{className:"msupsub",children:(0,l.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(n.span,{className:"vlist-r",children:[(0,l.jsx)(n.span,{className:"vlist",style:{height:"0.3361em"},children:(0,l.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,l.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(n.span,{className:"mord mtight",children:[(0,l.jsx)(n.span,{className:"mord mathnormal mtight",style:{marginRight:"0.01968em"},children:"l"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",children:"o"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",children:"a"}),(0,l.jsx)(n.span,{className:"mord mathnormal mtight",children:"d"})]})})]})}),(0,l.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(n.span,{className:"vlist-r",children:(0,l.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(n.span,{})})})]})})]}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(n.span,{className:"mrel",children:"="}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(n.span,{className:"base",children:[(0,l.jsx)(n.span,{className:"strut",style:{height:"2.0463em",verticalAlign:"-0.686em"}}),(0,l.jsxs)(n.span,{className:"mord",children:[(0,l.jsx)(n.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(n.span,{className:"mfrac",children:(0,l.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(n.span,{className:"vlist-r",children:[(0,l.jsxs)(n.span,{className:"vlist",style:{height:"1.3603em"},children:[(0,l.jsxs)(n.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(n.span,{className:"mord",children:(0,l.jsx)(n.span,{className:"mord",children:"2"})})]}),(0,l.jsxs)(n.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(n.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(n.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(n.span,{className:"mord",children:[(0,l.jsx)(n.span,{className:"mord",children:"10"}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(n.span,{className:"mord text",children:(0,l.jsx)(n.span,{className:"mord",children:"pF"})}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(n.span,{className:"mbin",children:"\u2212"}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(n.span,{className:"mord",children:"5"}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(n.span,{className:"mord text",children:(0,l.jsx)(n.span,{className:"mord",children:"pF"})})]})]})]}),(0,l.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(n.span,{className:"vlist-r",children:(0,l.jsx)(n.span,{className:"vlist",style:{height:"0.686em"},children:(0,l.jsx)(n.span,{})})})]})}),(0,l.jsx)(n.span,{className:"mclose nulldelimiter"})]}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(n.span,{className:"mrel",children:"="}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(n.span,{className:"base",children:[(0,l.jsx)(n.span,{className:"strut",style:{height:"0.8778em",verticalAlign:"-0.1944em"}}),(0,l.jsx)(n.span,{className:"mord",children:"2.5"}),(0,l.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(n.span,{className:"mord text",children:(0,l.jsx)(n.span,{className:"mord",children:"pF"})})]})]})]})}),"\n",(0,l.jsx)(n.p,{children:"Implementation:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Use two 2.5 pF capacitors connected from each crystal pin to ground."}),"\n",(0,l.jsx)(n.li,{children:"Alternatively, if 2.5 pF capacitors are not readily available, use the nearest standard value (e.g., 3 pF) and adjust as necessary."}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"steps-in-kicad-to-add-load-capacitors",children:"Steps in KiCad to Add Load Capacitors"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Add Capacitors:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:'Select Add Symbol and search for "capacitor".'}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Choose Appropriate Capacitors:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Select capacitors with the calculated value (e.g., 2.5 pF or 3 pF)."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Place Capacitors on the Schematic:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Position one capacitor connected to HSE_IN."}),"\n",(0,l.jsx)(n.li,{children:"Position the second capacitor connected to HSE_OUT."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Connect to Ground:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ensure the other ends of both capacitors are connected to GND."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"crystal-circuit-without-feedback-resistor",children:"Crystal Circuit Without Feedback Resistor"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Simplified Design:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Omit the feedback resistor unless specific conditions necessitate its inclusion."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Advantages:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Reduced component count."}),"\n",(0,l.jsx)(n.li,{children:"Simplified routing and potentially lower cost."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Verification:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Consult AN2867 to confirm that omitting the feedback resistor is suitable for your specific application."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"6-connecting-the-crystal-in-kicad",children:"6. Connecting the Crystal in KiCad"}),"\n",(0,l.jsx)(n.h3,{id:"steps-to-connect-the-crystal-to-the-stm32",children:"Steps to Connect the Crystal to the STM32"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Connect Pin 1 of the Crystal:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Link to the HSE_IN pin (PD0) on the STM32 microcontroller."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Connect Pin 3 of the Crystal:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Link to the HSE_OUT pin (PD1) on the STM32 microcontroller."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Ground Pins 2 and 4 (Four-Pin Package):"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Connect to GND to minimize noise interference and enhance stability."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"routing-and-naming-the-net-labels",children:"Routing and Naming the Net Labels"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Net Labeling:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Assign clear and consistent net labels to facilitate PCB layout and troubleshooting."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Recommended Labels:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"HSE_IN: For connections to the HSE_IN (OSC_IN) pin."}),"\n",(0,l.jsx)(n.li,{children:"HSE_OUT: For connections to the HSE_OUT (OSC_OUT) pin."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Schematic Clarity:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ensure that all connections are logically organized and labeled to prevent confusion during the PCB design phase."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"best-practices-for-routing",children:"Best Practices for Routing"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Minimize Trace Lengths:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Keep traces between the crystal and STM32 pins as short as possible to reduce inductance and potential signal integrity issues."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Avoid Routing Near High-Frequency Signals:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Prevent interference by keeping the crystal circuit away from other high-speed or high-frequency signals on the PCB."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Use Ground Planes:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Implement ground planes to provide a low-impedance path for return currents, enhancing signal stability."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"7-reviewing-the-schematic-for-the-crystal-circuit",children:"7. Reviewing the Schematic for the Crystal Circuit"}),"\n",(0,l.jsx)(n.p,{children:"After integrating all components, it is crucial to thoroughly review the schematic to ensure correctness and reliability."}),"\n",(0,l.jsx)(n.h3,{id:"schematic-components-overview",children:"Schematic Components Overview"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Crystal Oscillator:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Connected between PD0 (HSE_IN) and PD1 (HSE_OUT) of the STM32."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Load Capacitors:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Two 10 pF capacitors connected from each crystal pin to GND."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Grounded Pins (Two and Four):"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Grounded to reduce noise and enhance signal stability."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"verification-checklist",children:"Verification Checklist"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Component Placement:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ensure all components (crystal, capacitors, resistors) are correctly placed and oriented."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Net Connections:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Confirm that all connections align with the intended net labels (e.g., HSE_IN, HSE_OUT)."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Value Accuracy:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Verify that all component values, especially load capacitors, match the calculated requirements."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Ground Connections:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Check that all ground connections are properly routed and connected to the common ground plane."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Symbol Accuracy:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ensure that the correct symbols (two-pin or four-pin crystal) are used based on the selected crystal package."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"8-validating-the-crystal-circuit",children:"8. Validating the Crystal Circuit"}),"\n",(0,l.jsx)(n.p,{children:"Prior to proceeding to PCB layout and manufacturing, validate the crystal oscillator circuit to prevent potential issues during operation."}),"\n",(0,l.jsx)(n.h3,{id:"validation-steps",children:"Validation Steps"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Check Net Names:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ensure all nets are labeled correctly and consistently (e.g., HSE_IN, HSE_OUT)."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Load Capacitor Verification:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Cross-reference the calculated load capacitors with the crystal's datasheet to ensure compliance."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Ground Connections:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Confirm that all ground connections for the crystal and capacitors are correctly routed and connected to the ground plane."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Component Footprints:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Verify that all components have the correct footprints assigned for PCB layout."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Electrical Rules Check (ERC):"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Run ERC in KiCad to identify and rectify any schematic errors or connectivity issues."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Peer Review:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Have another engineer or team member review the schematic for additional verification."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"troubleshooting-common-issues",children:"Troubleshooting Common Issues"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Oscillation Failure:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Re-examine load capacitor values and connections."}),"\n",(0,l.jsx)(n.li,{children:"Ensure that the crystal is compatible with the microcontroller."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Noise and Interference:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Improve grounding and shielding."}),"\n",(0,l.jsx)(n.li,{children:"Adjust component placement to minimize electromagnetic interference."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Incorrect Frequency:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Double-check crystal specifications and load capacitor calculations."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,l.jsx)(n.p,{children:"Integrating a crystal oscillator into your STM32 microcontroller design is fundamental for achieving precise and stable timing, which is essential for high-speed communication protocols and other time-critical applications. By meticulously selecting and placing the crystal oscillator and its associated components in KiCad, and adhering to the guidelines outlined in Application Note AN2867, you ensure a reliable and optimized design."}),"\n",(0,l.jsx)(n.h3,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Symbol Selection: Choose the appropriate crystal symbol in KiCad based on the package type."}),"\n",(0,l.jsx)(n.li,{children:"Load Capacitors: Accurately calculate and implement load capacitors to stabilize oscillation."}),"\n",(0,l.jsx)(n.li,{children:"Schematic Integrity: Maintain clear and consistent net labeling and grounding practices."}),"\n",(0,l.jsx)(n.li,{children:"Validation: Thoroughly review and validate the schematic to prevent design flaws."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"With a well-designed crystal oscillator circuit, your STM32 microcontroller will operate with a stable and accurate clock source, enabling robust performance in high-speed and timing-sensitive applications."})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>t});var i=s(6540);const l={},a=i.createContext(l);function c(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);