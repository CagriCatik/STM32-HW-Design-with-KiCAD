# Power, Reset, and Boot Configuration

The schematic integrates the complete power, decoupling, reset, and boot-mode circuitry required to bring the STM32F103C8Tx microcontroller into a stable and predictable operating state. The additions ensure clean startup behavior, noise-robust supply rails, a reliable manual reset mechanism, and selectable bootloader access for programming over USB or UART.

---

## Decoupling

import schematic from '@site/static/pcb/pin_config.png';

<div style={{ textAlign: 'center' }}>
  <img  
    src={schematic}
    alt="pin_config"
    style={{ width: '500px' }}
  />
</div>

The decoupling network provides broadband noise suppression and stabilizes the MCUâ€™s supply pins.

Multiple capacitors are connected in parallel across the +3.3 V rail:

* Several 100 nF ceramic capacitors positioned close to each VDD pin
* Additional small-value capacitors (10 nF) to suppress high-frequency transients
* Bulk capacitors (1 uF) on both the digital and analog rails
* A ferrite bead separating VDDA from VDD to reduce digital switching noise reaching the ADC domain

This structure minimizes supply impedance across a wide frequency range, reduces jitter, and protects the microcontroller from unstable input voltage during load transients.

---

## NRST conditioning circuit

### C9 (100 uF)

C9 is connected from NRST to ground and provides a long, clean power-on reset pulse. By holding NRST low during power-up, the MCU is prevented from starting until the supply rails are fully stable. The larger value (100 uF) extends this stabilization time, which improves reliability on noisy power sources, brown-outs, or slow USB-powered startup conditions.

### SW1 (manual reset switch)

The SPDT switch allows manual assertion and release of the NRST line:

* Switching to ground forces a hardware reset
* Switching to +3.3 V releases the reset and allows execution of user firmware

This provides deterministic, debuggable control over MCU resets without requiring power cycling.

### Internal pull-up (implicit)

The NRST pin includes an internal pull-up resistor. This removes the need for an external pull-up device. After reset is released, the internal pull-up restores NRST to logic high once the reset capacitor charge decays.

Net labeling on NRST ensures clarity during PCB routing and avoids ambiguous autogenerated names.

---

## BOOT0 configuration circuit

### R1 (pull-down resistor)

R1 ties the BOOT0 pin to ground. As a result, BOOT0 defaults to logic low, so the STM32F103 boots from internal flash memory during normal operation. This pull-down guarantees a defined logic level and prevents the pin from floating, which could otherwise cause unpredictable boot behavior.

### SW1 BOOT0 selector

The BOOT0 selector switch allows the user to toggle the boot mode:

* When switched to +3.3 V, BOOT0 is driven high, activating the system memory bootloader at the next reset
* When switched back to ground, BOOT0 returns to its normal flash-boot state

Enabling the internal bootloader allows programming via:

* USB DFU (supported on the USB-capable STM32F1 variants)
* UART
* CAN (where applicable)

This eliminates the requirement for an external SWD or JTAG debugger when loading firmware or recovering a device.

Net labeling on BOOT0 and its switch positions makes routing and design maintenance more straightforward.

---

## Summary of function

With the decoupling, reset conditioning, and boot-selection circuitry fully integrated, the system now provides:

* Stable and noise-robust digital and analog supply rails
* Controlled, extended power-on reset behavior
* Manual reset capability for debugging and firmware testing
* Selectable bootloader access without requiring external tools
* Clearly labeled nets to facilitate PCB layout and signal identification

These additions complete the essential startup infrastructure for the STM32F103C8Tx and establish a solid foundation for reliable operation, firmware development, and future expansion.
